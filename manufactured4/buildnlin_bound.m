function [Ne dNe]=buildnlin_bound(s,r,elementtype,order)
if (strcmpi(elementtype,'hex'))
    switch order
        case 1
            Ne=1/4*[(1-s)*(1-r), (1+s)*(1-r), (1+s)*(1+r), (1-s)*(1+r)];
            dNe=1/4*[-(1-r), (1-r), (1+r), -(1+r); -(1-s), -(1+s), (1+s), (1-s)];
        case 2
            Ne=[ (r*s*(r - 1)*(s - 1))/4, (r*s*(r - 1)*(s + 1))/4, (r*s*(r + 1)*(s + 1))/4, (r*s*(r + 1)*(s - 1))/4, -(r*(s^2 - 1)*(r - 1))/2, -(s*(r^2 - 1)*(s + 1))/2, -(r*(s^2 - 1)*(r + 1))/2, -(s*(r^2 - 1)*(s - 1))/2, (r^2 - 1)*(s^2 - 1)];
            dNe=[ (r*(2*s - 1)*(r - 1))/4, (r*(2*s + 1)*(r - 1))/4, (r*(2*s + 1)*(r + 1))/4, (r*(2*s - 1)*(r + 1))/4,             -r*s*(r - 1), -((r^2 - 1)*(2*s + 1))/2,             -r*s*(r + 1), -((r^2 - 1)*(2*s - 1))/2, 2*s*(r^2 - 1);...
                (s*(2*r - 1)*(s - 1))/4, (s*(2*r - 1)*(s + 1))/4, (s*(2*r + 1)*(s + 1))/4, (s*(2*r + 1)*(s - 1))/4, -((2*r - 1)*(s^2 - 1))/2,             -r*s*(s + 1), -((2*r + 1)*(s^2 - 1))/2,             -r*s*(s - 1), 2*r*(s^2 - 1)];
    end
elseif (strcmpi(elementtype,'tet'))
    %t=1-r-s;
    switch order
        case 1
            Ne=[s r 1-s-r];
            dNe=[1 0 -1;0 1 -1];
        case 2
            Ne=[ s*(2*s - 1), r*(2*r - 1), (2*r + 2*s - 1)*(r + s - 1), 4*r*s, -4*r*(r + s - 1), -4*s*(r + s - 1)];
            dNe=[ 4*s - 1,       0, 4*r + 4*s - 3, 4*r,          -4*r, 4 - 8*s - 4*r;...
                0, 4*r - 1, 4*r + 4*s - 3, 4*s, 4 - 4*s - 8*r,          -4*s];
    end
end
end